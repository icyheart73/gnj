/**
 * frontend.js
 *
 * @copyright  2018 GanjeSoft. All rights reserved.
 * @license MIT
 */
(function ($) {
    "use strict";
    var gnje = {
        init: function () {
            var wrap = $('.append-class');
            gnje.productFilter(wrap);
            gnje.gnje_category_accordion();
            gnje.gnje_Tabsfiler_Mobile(992);
        },
        //Image Comparison
        gnje_image_comparison: function ($target) {
            let $currentTarget = $target.find('.gnje-wrap-image-comparison');
            let beforelabel=!!$currentTarget.find('.before-img').attr('alt')?$currentTarget.find('.before-img').attr('alt'):'Before';
            let afterlabel=!!$currentTarget.find('.after-img').attr('alt')?$currentTarget.find('.after-img').attr('alt'):'After';
            let _orientation=!!$currentTarget.data('orientation')?$currentTarget.data('orientation'):'horizontal';
            $currentTarget.twentytwenty({
                orientation: _orientation,
                before_label: beforelabel, // Set a custom before label
                after_label: afterlabel, // Set a custom after label
            });
        },
        //Video Light Box
        gnje_video_light_box: function ($target) {
            $target.find('.gnje-video-button').on('click', function (e) {
                e.preventDefault();
                var url = $(this).attr('href');
                var config = $(this).data('gnje-config');
                var height = config.height;
                var width = config.width;
                var html = '<div class="gnje-video-mask"></div><div class="gnje-wrap-video-popup"><iframe src="' + url + '" height="' + height + '" width="' + width + '" ></iframe></div>';
                $('body').append(html);
            });
            $(document).on('click', '.gnje-video-mask', function () {
                $('.gnje-wrap-video-popup, .gnje-video-mask').fadeOut();
                setTimeout(function () {
                    $('.gnje-wrap-video-popup, .gnje-video-mask').remove();
                }, 500)
            });
        },
        // Image 360 view
        gnje_image_360_view: function ($target) {

            let $currentTarget = $target.find(".gnje-image-360-view");

            var config = JSON.parse($currentTarget.attr('data-gnje-config'));
            var frame_width = config['width'];
            var frame_height = config['height'];
            if (parseInt(frame_width) > $currentTarget.find('.gnje-wrap-img-360-view').width()) {
                var res = parseInt(frame_width) / parseInt(frame_height)
                frame_width = $currentTarget.find('.gnje-wrap-img-360-view').width();
                frame_height = parseInt(parseInt(frame_width) / res);
            }

            $currentTarget.find('.gnje-wrap-content-view').spritespin({
                // path to the source images.
                source: config['source'].split(','),
                width: frame_width, // width in pixels of the window/frame
                height: frame_height, // height in pixels of the window/frame
                animate: false
            });

            var api = $currentTarget.find('.gnje-wrap-content-view').spritespin("api");
            // call function next/previous frame when click to button next/previous
            $currentTarget.find('.gnje-control-view:not(.gnje-center)').on('click', function () {
                if ($currentTarget.hasClass('gnje-prev-item')) {
                    api.prevFrame();
                } else {
                    api.nextFrame();
                }
            });
        },
        //For productCarousel
        gnje_carousel: function () {
            $('.tab-product-slider').each(function() {

                // Configuration
                var row_count = $(this).data('row');
                var row_countMobile = $(this).data('rowmobile');
                var column_count = $(this).data('column');
                var column_countMobile = $(this).data('columnmobile');
                var slider_autoplay = $(this).data('autoplay');
                var brkpnt = {640 : {slidesPerView: column_countMobile, spaceBetween: 20, slidesPerColumn : row_countMobile}};

                var conf_slider 	= {};
                conf_slider.slidesPerView = column_count;
                conf_slider.slidesPerColumn = row_count;
                conf_slider.spaceBetween = 30;
                conf_slider.pagination = {el: '.swiper-pagination',clickable: true,};
                conf_slider.navigation = {nextEl: '.swiper-gnj-next', prevEl: '.swiper-gnj-prev',};
                conf_slider.breakpoints = brkpnt;
                console.log(conf_slider);
                if(slider_autoplay)
                    conf_slider.autoplay = { delay : 5000 , disableOnInteraction : false};
                //Initialize
                var tslider = new Swiper( this , conf_slider);
            });
        },
        // Filter Product
        productFilter: function (wrap) {

            wrap.find('.gnje-ajax-load a').on('click', function (e) {
                e.preventDefault();
                var $this = $(this);
                wrap = $this.parents('.append-class');
                if ($this.hasClass('active')) {
                    return;
                }
                $this.parents('.gnje-ajax-load ').find('a').removeClass('active');
                $this.addClass('active');
                if ($this.hasClass('opened')) {
                    let key = $this.data('value');
                    wrap.find('.products').html(wrap.find('.products').data(key));
                    return;
                }

                $this.addClass('opened');
                wrap.addClass('loading');
                var data = wrap.data('args');
                data['action'] = 'gnje_ajax_product_filter';
                if ($this.data('type') == 'product_cat') {
                    data['filter_categories'] = $this.data('value');
                }
                if ($this.data('type') == 'asset_type') {
                    data['asset_type'] = $this.data('value');
                }
                wrap.data('args', data);
                $.ajax({
                    url: wrap.data('url'),
                    data: data,
                    type: 'POST',
                }).success(function (response) {
                    wrap.removeClass('loading');
                    $this.removeClass('opened');
                    let key;
                    if (data['filter_categories']) {
                        key = data['filter_categories'];
                    }else if (data['asset_type']) {
                        key = data['asset_type'];
                    }

                    wrap.find('.tab-product-slider').html(response);
                    wrap.find('.tab-product-slider').data(key,response);
                    if (wrap.hasClass('gnje-carousel')) {
                        //wrap.find('.products').removeClass('slick-initialized slick-slider slick-dotted');
                        gnje.gnje_carousel();
                    }
                }).error(function (ex) {
                    console.log(ex);
                });
            });
        },
        // Image 360 view
        gnje_category_accordion: function () {
            $(document).on('click', '.gnje-btn-accordion', function () {
                $(this).closest('.gnje-cat-item').toggleClass('activated');
                $(this).next('.gnje-sub-cat').slideToggle();
            });
        },
        // Progress bar
        gnje_progress_bar:function () {
            $(window).load(function () {
                $('.gnje-wrap-progress-bar:not(.loaded)').each(function () {
                    if($(window).scrollTop() + $(window).height() > $(this).offset().top){
                        gnje_progress_bar_animate($(this));
                    }
                });
            });
            $(window).on('scroll',function () {
                $('.gnje-wrap-progress-bar:not(.loaded)').each(function () {
                    if($(window).scrollTop() + $(window).height() > $(this).offset().top){
                        gnje_progress_bar_animate($(this));
                    }
                });
            });
            function gnje_progress_bar_animate($current) {
                $current.addClass('loaded');
                var config=$current.data('gnje-config');
                var percent=config.percent;
                if(!!percent) {
                    var duration=Math.round(config.duration/(percent+10));
                    var width = 0;
                    var id = setInterval(frame, duration);
                    function frame() {
                        if (width >= percent) {
                            clearInterval(id);
                        } else {
                            width++;
                            $current.find('.value').text(width);
                            $current.find('.gnje-progress-bar').css('width', width + '%');
                        }
                    }
                }
            }
        },

        //Tabs filter in mobile
        gnje_Tabsfiler_Mobile: function($poiter) {
            $('.gnje-head-product-filter.has-tabs .gnje-title').css('cursor','pointer');
            $(document).on('click', '.gnje-head-product-filter.has-tabs .gnje-title', function () {
                var w = $(window).width();
                if (w <= $poiter) {
                    $(this).parent().find('.gnje-ajax-load').slideToggle();
                    $(this).toggleClass('active');

                    return false;
                }
            });
        },
    };
    window.gnje = gnje;
    // DOCUMENT READY
    $(function () {
        gnje.init();
    });
    $(window).on('elementor/frontend/init', function () {
        //Image Comparison
        elementorFrontend.hooks.addAction(
            "frontend/element_ready/ganje-image-comparison.default",
            gnje.gnje_image_comparison
        );
        //Image 360 view
        elementorFrontend.hooks.addAction(
            "frontend/element_ready/ganje-image-360-view.default",
            gnje.gnje_image_360_view
        );
        //Video Lightbox
        elementorFrontend.hooks.addAction(
            "frontend/element_ready/ganje-video-light-box.default",
            gnje.gnje_video_light_box
        );
        //Progress bar
        elementorFrontend.hooks.addAction(
            "frontend/element_ready/ganje-progress-bar.default",
            gnje.gnje_progress_bar
        );
    });
})(jQuery);


// webpackModules
(function (modules) {
    // The module cache
    var $ = jQuery,
        installedModules = {};

    // The require function
    function __webpack_require__(moduleId) {

        // Check if module is in cache
        if (installedModules[moduleId]) {
            return installedModules[moduleId].exports;
        }
        // Create a new module (and put it into the cache)
        var module = installedModules[moduleId] = {
            i: moduleId,
            l: false,
            exports: {}
        };

        // Execute the module function
        //modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

        // Flag the module as loaded
        module.l = true;

        // Return the exports of the module
        return module.exports;
    }

    // expose the modules object (__webpack_modules__)
    __webpack_require__.m = modules;

    // expose the module cache
    __webpack_require__.c = installedModules;

    // define getter function for harmony exports
    __webpack_require__.d = function (exports, name, getter) {
        if (!__webpack_require__.o(exports, name)) {
            Object.defineProperty(exports, name, {
                enumerable: true,
                get: getter
            });
        }
    };

    // define __esModule on exports
    __webpack_require__.r = function (exports) {
        if (typeof Symbol !== 'undefined' && Symbol.toStringTag) {
            Object.defineProperty(exports, Symbol.toStringTag, {
                value: 'Module'
            });
        }
        Object.defineProperty(exports, '__esModule', {
            value: true
        });
    };

    // create a fake namespace object
    // mode & 1: value is a module id, require it
    // mode & 2: merge all properties of value into the ns
    // mode & 4: return value when already ns object
    // mode & 8|1: behave like require
    __webpack_require__.t = function (value, mode) {
        if (mode & 1) value = __webpack_require__(value);
        if (mode & 8) return value;
        if ((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
        var ns = Object.create(null);
        __webpack_require__.r(ns);
        Object.defineProperty(ns, 'default', {
            enumerable: true,
            value: value
        });
        if (mode & 2 && typeof value != 'string')
            for (var key in value) __webpack_require__.d(ns, key, function (key) {
                return value[key];
            }.bind(null, key));
        return ns;
    };

    // getDefaultExport function for compatibility with non-harmony modules
    __webpack_require__.n = function (module) {
        var getter = module && module.__esModule ?
            function getDefault() {
                return module['default'];
            } :
            function getModuleExports() {
                return module;
            };
        __webpack_require__.d(getter, 'a', getter);
        return getter;
    };

    // Object.prototype.hasOwnProperty.call
    __webpack_require__.o = function (object, property) {
        return Object.prototype.hasOwnProperty.call(object, property);
    };

    // __webpack_public_path__
    __webpack_require__.p = '';

    // Load entry module and return exports
    return __webpack_require__(__webpack_require__.s = 0);
})
([
    /* 0 */
    (function (module, exports, __webpack_require__) {
        'use strict';

        function GanjeAddonsForElementor(elementor) {
            var self = this,
                handlers = {
                    slider: __webpack_require__(1)
                };
            this.modules = {};
            self.modules = {};
            jQuery.each(handlers, function (moduleName) {
                self.modules[moduleName] = new this(elementor);
            });

        }
        jQuery(window).on('elementor/frontend/init', function () {
            window.gnjeFrontend = new GanjeAddonsForElementor(elementorFrontend);
        });
    }),
    /* 1 */
    (function (module, exports, __webpack_require__) {
        'use strict';

        module.exports = function (elementor) {
            elementor.hooks.addAction('frontend/element_ready/ganje-slider.default', __webpack_require__(2));
            elementor.hooks.addAction('frontend/element_ready/ganje-section-bookmark.default', __webpack_require__(3));
            elementor.hooks.addAction('frontend/element_ready/ganje-edd-tabs.default', __webpack_require__(4));
            elementor.hooks.addAction('frontend/element_ready/ganje-scroll-to.default', __webpack_require__(7));
        };
    }),

    /* 4 */
    (function (module, exports, __webpack_require__) {
        'use strict';

        var TabsModule = __webpack_require__(5);

        module.exports = function ($scope) {
            new TabsModule({
                $element: $scope,
                toggleSelf: false
            });
        };
    }),
    /* 5 */
    (function (module, exports, __webpack_require__) {
        "use strict";

        var HandlerModule = __webpack_require__(6);

        module.exports = HandlerModule.extend({
            $activeContent: null,

            getDefaultSettings: function getDefaultSettings() {
                return {
                    selectors: {
                        tabTitle: '.elementor-tab-title',
                        tabContent: '.elementor-tab-content'
                    },
                    classes: {
                        active: 'elementor-active'
                    },
                    showTabFn: 'show',
                    hideTabFn: 'hide',
                    toggleSelf: true,
                    hidePrevious: true,
                    autoExpand: true
                };
            },

            getDefaultElements: function getDefaultElements() {
                var selectors = this.getSettings('selectors');

                return {
                    $tabTitles: this.findElement(selectors.tabTitle),
                    $tabContents: this.findElement(selectors.tabContent)
                };
            },

            activateDefaultTab: function activateDefaultTab() {
                var settings = this.getSettings();

                if (!settings.autoExpand || 'editor' === settings.autoExpand && !this.isEdit) {
                    return;
                }

                var defaultActiveTab = this.getEditSettings('activeItemIndex') || 1,
                    originalToggleMethods = {
                        showTabFn: settings.showTabFn,
                        hideTabFn: settings.hideTabFn
                    };

                // Toggle tabs without animation to avoid jumping
                this.setSettings({
                    showTabFn: 'show',
                    hideTabFn: 'hide'
                });

                this.changeActiveTab(defaultActiveTab);

                // Return back original toggle effects
                this.setSettings(originalToggleMethods);
            },

            deactivateActiveTab: function deactivateActiveTab(tabIndex) {
                var settings = this.getSettings(),
                    activeClass = settings.classes.active,
                    activeFilter = tabIndex ? '[data-tab="' + tabIndex + '"]' : '.' + activeClass,
                    $activeTitle = this.elements.$tabTitles.filter(activeFilter),
                    $activeContent = this.elements.$tabContents.filter(activeFilter);

                $activeTitle.add($activeContent).removeClass(activeClass);

                $activeContent[settings.hideTabFn]();
            },

            activateTab: function activateTab(tabIndex) {
                var settings = this.getSettings(),
                    activeClass = settings.classes.active,
                    $requestedTitle = this.elements.$tabTitles.filter('[data-tab="' + tabIndex + '"]'),
                    $requestedContent = this.elements.$tabContents.filter('[data-tab="' + tabIndex + '"]');

                $requestedTitle.add($requestedContent).addClass(activeClass);

                $requestedContent[settings.showTabFn]();
            },

            isActiveTab: function isActiveTab(tabIndex) {
                return this.elements.$tabTitles.filter('[data-tab="' + tabIndex + '"]').hasClass(this.getSettings('classes.active'));
            },

            bindEvents: function bindEvents() {
                var _this = this;

                this.elements.$tabTitles.on({
                    keydown: function keydown(event) {
                        if ('Enter' === event.key) {
                            event.preventDefault();

                            _this.changeActiveTab(event.currentTarget.dataset.tab);
                        }
                    },
                    click: function click(event) {
                        event.preventDefault();

                        _this.changeActiveTab(event.currentTarget.dataset.tab);
                    }
                });
            },

            onInit: function onInit() {
                HandlerModule.prototype.onInit.apply(this, arguments);

                this.activateDefaultTab();
            },

            onEditSettingsChange: function onEditSettingsChange(propertyName) {
                if ('activeItemIndex' === propertyName) {
                    this.activateDefaultTab();
                }
            },

            changeActiveTab: function changeActiveTab(tabIndex) {
                var isActiveTab = this.isActiveTab(tabIndex),
                    settings = this.getSettings();

                if ((settings.toggleSelf || !isActiveTab) && settings.hidePrevious) {
                    this.deactivateActiveTab();
                }

                if (!settings.hidePrevious && isActiveTab) {
                    this.deactivateActiveTab(tabIndex);
                }

                if (!isActiveTab) {
                    this.activateTab(tabIndex);
                }
            }
        });
    }),
    /* 6 */
    (function (module, exports, __webpack_require__) {

        "use strict";


        module.exports = elementorModules.ViewModule.extend({
            $element: null,

            editorListeners: null,

            onElementChange: null,

            onEditSettingsChange: null,

            onGeneralSettingsChange: null,

            onPageSettingsChange: null,

            isEdit: null,

            __construct: function __construct(settings) {
                this.$element = settings.$element;

                this.isEdit = this.$element.hasClass('elementor-element-edit-mode');

                if (this.isEdit) {
                    this.addEditorListeners();
                }
            },

            findElement: function findElement(selector) {
                var $mainElement = this.$element;

                return $mainElement.find(selector).filter(function () {
                    return jQuery(this).closest('.elementor-element').is($mainElement);
                });
            },

            getUniqueHandlerID: function getUniqueHandlerID(cid, $element) {
                if (!cid) {
                    cid = this.getModelCID();
                }

                if (!$element) {
                    $element = this.$element;
                }

                return cid + $element.attr('data-element_type') + this.getConstructorID();
            },

            initEditorListeners: function initEditorListeners() {
                var self = this;

                self.editorListeners = [{
                    event: 'element:destroy',
                    to: elementor.channels.data,
                    callback: function callback(removedModel) {
                        if (removedModel.cid !== self.getModelCID()) {
                            return;
                        }

                        self.onDestroy();
                    }
                }];

                if (self.onElementChange) {
                    var elementName = self.getElementName(),
                        eventName = 'change';

                    if ('global' !== elementName) {
                        eventName += ':' + elementName;
                    }

                    self.editorListeners.push({
                        event: eventName,
                        to: elementor.channels.editor,
                        callback: function callback(controlView, elementView) {
                            var elementViewHandlerID = self.getUniqueHandlerID(elementView.model.cid, elementView.$el);

                            if (elementViewHandlerID !== self.getUniqueHandlerID()) {
                                return;
                            }

                            self.onElementChange(controlView.model.get('name'), controlView, elementView);
                        }
                    });
                }

                if (self.onEditSettingsChange) {
                    self.editorListeners.push({
                        event: 'change:editSettings',
                        to: elementor.channels.editor,
                        callback: function callback(changedModel, view) {
                            if (view.model.cid !== self.getModelCID()) {
                                return;
                            }

                            self.onEditSettingsChange(Object.keys(changedModel.changed)[0]);
                        }
                    });
                }

                ['page', 'general'].forEach(function (settingsType) {
                    var listenerMethodName = 'on' + settingsType[0].toUpperCase() + settingsType.slice(1) + 'SettingsChange';

                    if (self[listenerMethodName]) {
                        self.editorListeners.push({
                            event: 'change',
                            to: elementor.settings[settingsType].model,
                            callback: function callback(model) {
                                self[listenerMethodName](model.changed);
                            }
                        });
                    }
                });
            },

            getEditorListeners: function getEditorListeners() {
                if (!this.editorListeners) {
                    this.initEditorListeners();
                }

                return this.editorListeners;
            },

            addEditorListeners: function addEditorListeners() {
                var uniqueHandlerID = this.getUniqueHandlerID();

                this.getEditorListeners().forEach(function (listener) {
                    elementorFrontend.addListenerOnce(uniqueHandlerID, listener.event, listener.callback, listener.to);
                });
            },

            removeEditorListeners: function removeEditorListeners() {
                var uniqueHandlerID = this.getUniqueHandlerID();

                this.getEditorListeners().forEach(function (listener) {
                    elementorFrontend.removeListeners(uniqueHandlerID, listener.event, null, listener.to);
                });
            },

            getElementName: function getElementName() {
                return this.$element.data('element_type').split('.')[0];
            },

            getID: function getID() {
                return this.$element.data('id');
            },

            getModelCID: function getModelCID() {
                return this.$element.data('model-cid');
            },

            getElementSettings: function getElementSettings(setting) {
                var elementSettings = {},
                    modelCID = this.getModelCID();

                if (this.isEdit && modelCID) {
                    var settings = elementorFrontend.config.elements.data[modelCID],
                        settingsKeys = elementorFrontend.config.elements.keys[settings.attributes.widgetType || settings.attributes.elType];

                    jQuery.each(settings.getActiveControls(), function (controlKey) {
                        if (-1 !== settingsKeys.indexOf(controlKey)) {
                            elementSettings[controlKey] = settings.attributes[controlKey];
                        }
                    });
                } else {
                    elementSettings = this.$element.data('settings') || {};
                }

                return this.getItems(elementSettings, setting);
            },

            getEditSettings: function getEditSettings(setting) {
                var attributes = {};

                if (this.isEdit) {
                    attributes = elementorFrontend.config.elements.editSettings[this.getModelCID()].attributes;
                }

                return this.getItems(attributes, setting);
            },

            onDestroy: function onDestroy() {
                this.removeEditorListeners();

                if (this.unbindEvents) {
                    this.unbindEvents();
                }
            }
        });
    }),
    /* 7 */
    (function (module, exports, __webpack_require__) {

        function GanjeScrollTo($selector, settings) {
            var $ = jQuery,
                self = this,
                $window = $(window),
                $instance = $selector,
                checkTemps = $selector.find(".gnje-scrollto-sections-wrap").length,
                $htmlBody = $("html, body"),
                deviceType = $("body").data("elementor-device-mode"),
                $itemsList = $(".gnje-scrollto-nav-item", $instance),
                $menuItems = $(".gnje-scrollto-nav-menu-item", $instance),
                defaultSettings = {
                    speed: 1000,
                    offset: 1,
                    fullSection: true
                },
                settings = $.extend({}, defaultSettings, settings),
                sections = {},
                currentSection = null,
                isScrolling = false;

            jQuery.extend(jQuery.easing, {
                easeInOutCirc: function (x, t, b, c, d) {
                    if ((t /= d / 2) < 1) return (-c / 2) * (Math.sqrt(1 - t * t) - 1) + b;
                    return (c / 2) * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;
                }
            });

            self.checkNextSection = function (object, key) {
                var keys = Object.keys(object),
                    idIndex = keys.indexOf(key),
                    nextIndex = (idIndex += 1);

                if (nextIndex >= keys.length) {
                    return false;
                }

                var nextKey = keys[nextIndex];

                return nextKey;
            };

            self.checkPrevSection = function (object, key) {
                var keys = Object.keys(object),
                    idIndex = keys.indexOf(key),
                    prevIndex = (idIndex -= 1);

                if (0 > idIndex) {
                    return false;
                }

                var prevKey = keys[prevIndex];

                return prevKey;
            };

            self.debounce = function (threshold, callback) {
                var timeout;

                return function debounced($event) {
                    function delayed() {
                        callback.call(this, $event);
                        timeout = null;
                    }

                    if (timeout) {
                        clearTimeout(timeout);
                    }

                    timeout = setTimeout(delayed, threshold);
                };
            };
            self.visible = function (selector, partial, hidden) {

                var s = selector.get(0),
                    vpHeight = $window.outerHeight(),
                    clientSize = hidden === true ? s.offsetWidth * s.offsetHeight : true;
                if (typeof s.getBoundingClientRect === 'function') {
                    var rec = s.getBoundingClientRect();
                    var tViz = rec.top >= 0 && rec.top < vpHeight,
                        bViz = rec.bottom > 0 && rec.bottom <= vpHeight,
                        vVisible = partial ? tViz || bViz : tViz && bViz,
                        vVisible = (rec.top < 0 && rec.bottom > vpHeight) ? true : vVisible;
                    return clientSize && vVisible;
                } else {
                    var viewTop = 0,
                        viewBottom = viewTop + vpHeight,
                        position = $window.position(),
                        _top = position.top,
                        _bottom = _top + $window.height(),
                        compareTop = partial === true ? _bottom : _top,
                        compareBottom = partial === true ? _top : _bottom;
                    return !!clientSize && ((compareBottom <= viewBottom) && (compareTop >= viewTop));
                }

            };

            self.init = function () {
                self.setSectionsData();
                $itemsList.on("click.premiumVerticalScroll", self.onNavDotChange);
                $menuItems.on("click.premiumVerticalScroll", self.onNavDotChange);

                $itemsList.on("mouseenter.premiumVerticalScroll", self.onNavDotEnter);

                $itemsList.on("mouseleave.premiumVerticalScroll", self.onNavDotLeave);

                if (deviceType === "desktop") {
                    $window.on("scroll.premiumVerticalScroll", self.onWheel);
                }
                $window.on(
                    "resize.premiumVerticalScroll orientationchange.premiumVerticalScroll",
                    self.debounce(50, self.onResize)
                );
                $window.on("load", function () {
                    self.setSectionsData();
                });

                $(document).keydown(function (event) {
                    if (38 == event.keyCode) {
                        self.onKeyUp(event, "up");
                    }

                    if (40 == event.keyCode) {
                        self.onKeyUp(event, "down");
                    }
                });
                if (settings.fullSection) {
                    var vSection = document.getElementById($instance.attr("id"));
                    if (checkTemps) {
                        document.addEventListener ?
                            vSection.addEventListener("wheel", self.onWheel, !1) :
                            vSection.attachEvent("onmousewheel", self.onWheel);
                    } else {
                        document.addEventListener ?
                            document.addEventListener("wheel", self.onWheel, !1) :
                            document.attachEvent("onmousewheel", self.onWheel);
                    }
                }

                for (var section in sections) {
                    var $section = sections[section].selector;
                    elementorFrontend.waypoint(
                        $section,
                        function (direction) {
                            var $this = $(this),
                                sectionId = $this.attr("id");
                            if ("down" === direction && !isScrolling) {
                                currentSection = sectionId;
                                $itemsList.removeClass("active");
                                $menuItems.removeClass("active");
                                $("[data-menuanchor=" + sectionId + "]", $instance).addClass(
                                    "active"
                                );
                            }
                        }, {
                            offset: "95%",
                            triggerOnce: false
                        }
                    );

                    elementorFrontend.waypoint(
                        $section,
                        function (direction) {
                            var $this = $(this),
                                sectionId = $this.attr("id");
                            if ("up" === direction && !isScrolling) {
                                currentSection = sectionId;
                                $itemsList.removeClass("active");
                                $menuItems.removeClass("active");
                                $("[data-menuanchor=" + sectionId + "]", $instance).addClass(
                                    "active"
                                );
                            }
                        }, {
                            offset: "0%",
                            triggerOnce: false
                        }
                    );
                }
            };

            self.setSectionsData = function () {
                $itemsList.each(function () {
                    var $this = $(this),
                        sectionId = $this.data("menuanchor"),
                        $section = $("#" + sectionId);
                    if ($section[0]) {
                        sections[sectionId] = {
                            selector: $section,
                            offset: Math.round($section.offset().top),
                            height: $section.outerHeight()
                        };
                    }
                });
            };

            self.onNavDotEnter = function () {
                var $this = $(this),
                    index = $this.data("index");
                if (settings.tooltips) {
                    $('<div class="gnje-scrollto-nav-item-tooltip"><span>' + $this.data('label') + '</span></div>').hide().appendTo($this).fadeIn(200);
                }
            };

            self.onNavDotLeave = function () {
                $(".gnje-scrollto-nav-item-tooltip").fadeOut(200, function () {
                    $(this).remove();
                });
            };

            self.onNavDotChange = function (event) {
                var $this = $(this),
                    index = $this.index(),
                    sectionId = $this.data("menuanchor"),
                    offset = null;

                if (!sections.hasOwnProperty(sectionId)) {
                    return false;
                }

                offset = sections[sectionId].offset - settings.offset;

                if (!isScrolling) {
                    isScrolling = true;

                    currentSection = sectionId;
                    $menuItems.removeClass("active");
                    $itemsList.removeClass("active");

                    if ($this.hasClass("gnje-scrollto-nav-menu-item")) {
                        $($itemsList[index]).addClass("active");
                    } else {
                        $($menuItems[index]).addClass("active");
                    }

                    $this.addClass("active");

                    $htmlBody
                        .stop()
                        .clearQueue()
                        .animate({
                                scrollTop: offset
                            },
                            settings.speed,
                            "easeInOutCirc",
                            function () {
                                isScrolling = false;
                            }
                        );
                }
            };

            self.onKeyUp = function (event, direction) {
                var direction = direction || "up",
                    sectionId,
                    nextItem = $(
                        ".gnje-scrollto-nav-item[data-menuanchor=" + currentSection + "]",
                        $instance
                    ).next(),
                    prevItem = $(
                        ".gnje-scrollto-nav-item[data-menuanchor=" + currentSection + "]",
                        $instance
                    ).prev();

                event.preventDefault();

                if (isScrolling) {
                    return false;
                }

                if ("up" === direction) {
                    if (prevItem[0]) {
                        prevItem.trigger("click.premiumVerticalScroll");
                    }
                }

                if ("down" === direction) {
                    if (nextItem[0]) {
                        nextItem.trigger("click.premiumVerticalScroll");
                    }
                }
            };

            self.onScroll = function (event) {
                /* On Scroll Event */
                if (isScrolling) {
                    event.preventDefault();
                }
            };

            function getFirstSection(object) {
                return Object.keys(object)[0];
            }

            function getLastSection(object) {
                return Object.keys(object)[Object.keys(object).length - 1];
            }

            function getDirection(e) {
                e = window.event || e;
                var t = Math.max(-1, Math.min(1, e.wheelDelta || -e.deltaY || -e.detail));
                return t;
            }

            self.onWheel = function (event) {
                if (isScrolling) {
                    event.preventDefault();
                    return false;
                }

                var $target = $(event.target),
                    sectionSelector = checkTemps ?
                        ".gnje-scrollto-temp" :
                        ".elementor-top-section",
                    $section = $target.closest(sectionSelector),
                    $vTarget = self.visible($instance, true, false),
                    sectionId = $section.attr("id"),
                    offset = 0,
                    newSectionId = false,
                    prevSectionId = false,
                    nextSectionId = false,
                    delta = getDirection(event),
                    direction = 0 > delta ? "down" : "up",
                    windowScrollTop = $window.scrollTop(),
                    dotIndex = $(".gnje-scrollto-nav-item.active").index();
                if ("mobile" === deviceType || "tablet" === deviceType) {
                    $(".gnje-scrollto-nav-item-tooltip").hide();
                    if (dotIndex === $itemsList.length - 1 && !$vTarget) {
                        $(".gnje-scrollto-nav-icons, .gnje-scrollto-nav-menu").addClass(
                            "gnje-scrollto-nav-icons-hide"
                        );
                    } else if (dotIndex === 0 && !$vTarget) {
                        if ($instance.offset().top - $(document).scrollTop() > 200) {
                            $(".gnje-scrollto-nav-icons, .gnje-scrollto-nav-menu").addClass(
                                "gnje-scrollto-nav-icons-hide"
                            );
                        }
                    } else {
                        $(".gnje-scrollto-nav-icons, .gnje-scrollto-nav-menu").removeClass(
                            "gnje-scrollto-nav-icons-hide"
                        );
                    }
                }

                if (beforeCheck()) {
                    sectionId = getFirstSection(sections);
                }

                if (afterCheck()) {
                    sectionId = getLastSection(sections);
                }
                if (sectionId && sections.hasOwnProperty(sectionId)) {
                    prevSectionId = self.checkPrevSection(sections, sectionId);
                    nextSectionId = self.checkNextSection(sections, sectionId);
                    if ("up" === direction) {
                        if (!nextSectionId && sections[sectionId].offset < windowScrollTop) {
                            newSectionId = sectionId;
                        } else {
                            newSectionId = prevSectionId;
                        }
                    }

                    if ("down" === direction) {
                        if (
                            !prevSectionId &&
                            sections[sectionId].offset > windowScrollTop + 5
                        ) {
                            newSectionId = sectionId;
                        } else {
                            newSectionId = nextSectionId;
                        }
                    }

                    if (newSectionId) {
                        $(".gnje-scrollto-nav-icons, .gnje-scrollto-nav-menu").removeClass(
                            "gnje-scrollto-nav-icons-hide"
                        );
                        event.preventDefault();
                        offset = sections[newSectionId].offset - settings.offset;
                        currentSection = newSectionId;
                        $itemsList.removeClass("active");
                        $menuItems.removeClass("active");
                        $("[data-menuanchor=" + newSectionId + "]", $instance).addClass(
                            "active"
                        );

                        isScrolling = true;
                        self.scrollStop();
                        $htmlBody.animate({
                                scrollTop: offset
                            },
                            settings.speed,
                            "easeInOutCirc",
                            function () {
                                isScrolling = false;
                            }
                        );
                    } else {
                        var $lastselector = checkTemps ? $instance : $("#" + sectionId);
                        if ("down" === direction) {
                            if (
                                $lastselector.offset().top +
                                $lastselector.innerHeight() -
                                $(document).scrollTop() >
                                600
                            ) {
                                $(".gnje-scrollto-nav-icons, .gnje-scrollto-nav-menu").addClass(
                                    "gnje-scrollto-nav-icons-hide"
                                );
                            }
                        } else if ("up" === direction) {
                            if ($lastselector.offset().top - $(document).scrollTop() > 200) {
                                $(".gnje-scrollto-nav-icons, .gnje-scrollto-nav-menu").addClass(
                                    "gnje-scrollto-nav-icons-hide"
                                );
                            }
                        }
                    }
                }
            };

            function beforeCheck(event) {
                var windowScrollTop = $window.scrollTop(),
                    firstSectionId = getFirstSection(sections),
                    offset = sections[firstSectionId].offset,
                    topBorder = windowScrollTop + $window.outerHeight(),
                    visible = self.visible($instance, true, false);

                if (topBorder > offset) {
                    return false;
                } else if (visible) {
                    return true;
                }
                return false;
            }

            function afterCheck(event) {
                var windowScrollTop = $window.scrollTop(),
                    lastSectionId = getLastSection(sections),
                    offset = sections[lastSectionId].offset,
                    bottomBorder =
                        sections[lastSectionId].offset + sections[lastSectionId].height,
                    visible = self.visible($instance, true, false);

                if (windowScrollTop < bottomBorder) {
                    return false;
                } else if (visible) {
                    return true;
                }

                return false;
            }

            self.onResize = function (event) {
                self.setSectionsData();
            };

            self.scrollStop = function () {
                $htmlBody.stop(true);
            };
        };

        module.exports = function ($scope) {
            var section = $scope.find(".gnje-scrollto-section");
            var module = new GanjeScrollTo(section, section.data("settings"));
            module.init();
        }
    })
]);
